#!/bin/bash
for_app=$1
cudid=0

if [[ -z "$for_app" ]]; then
  echo "You did not specify an app name."
  echo "./run [ app_name ]"
  exit
fi

echo "Making sure we have a connection to a device...We can wait forever here..."
while [ $cudid -eq 0 ]
do
  udid=($(system_profiler SPUSBDataType | grep -A 10 iP | grep Serial | cut -d: -f2))
  udid=${udid[device_order]}
  cudid=${#udid}
done

udid=${udid// /}
echo "Starting automation for $for_app on $udid"

ruby cucumber.rb $for_app $udid
